<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MediCare Admin - Customer Management</title>
  <meta name="description" content="Quản lý khách hàng MediCare - Xem, chỉnh sửa, xóa, theo dõi lịch sử đơn hàng">
  <link rel="preload" href="../assets/images/LOGO Vàng MediCare.png" as="image">
  <link rel="preload" href="../assets/images/logo_tròn.png" as="image">
  <link rel="icon" type="image/png" href="../assets/images/logo_tròn.png">
  <link rel="stylesheet" href="../css/admin_homepage.css">
  <link rel="stylesheet" href="../css/admin_cusmanagement.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="../css/style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="../js/admin_cusmanagement.js" defer></script>
</head>
<body>
  <!-- HEADER -->
  <header class="admin-header" role="banner">
    <div class="admin-header-left">
      <button class="hamburger" id="hamburgerBtn" aria-label="Mở/đóng menu sidebar" aria-expanded="false">
        <span></span><span></span><span></span>
      </button>
      <img src="../assets/images/LOGO Vàng MediCare.png" alt="Logo MediCare" class="admin-logo" loading="eager">
      <h1 class="admin-title">MediCare Admin Portal</h1>
    </div>

    <div class="admin-header-center">
      <div class="search-container">
        <i class="fas fa-search search-icon"></i>
        <input type="search" placeholder="Tìm kiếm khách hàng, email..." class="admin-search" 
               aria-label="Tìm kiếm" autocomplete="off">
      </div>
    </div>

    <div class="admin-header-right">
      <div class="admin-icon notif" role="button" tabindex="0" aria-label="Thông báo (3 chưa đọc)">
        <button class="notif-bell has-unread" id="notifBtn" aria-expanded="false">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M12 2a5 5 0 00-5 5v2.09c0 .53-.21 1.04-.59 1.41L4.7 12.62A1 1 0 005 14h14a1 1 0 00.83-1.57l-1.71-2.12a2 2 0 01-.45-1.28V7a5 5 0 00-5-5zm0 20a3 3 0 01-2.82-2h5.64A3 3 0 0112 22z"/>
          </svg>
          <span class="notif-badge" aria-hidden="true">3</span>
        </button>
        <!-- Notification Dropdown -->
        <div class="notif-dropdown" id="notifDropdown" role="menu" aria-labelledby="notifBtn">
          <div class="notif-head">
            <span>Thông báo</span>
            <span class="notif-count">3 chưa đọc</span>
          </div>
          <ul role="menu" aria-label="Danh sách thông báo">
            <li role="menuitem">
              <div class="notif-item">
                <i class="notif-icon fas fa-shopping-cart"></i>
                <div>3 đơn hàng mới hôm nay</div>
                <span class="notif-time">2 phút trước</span>
              </div>
            </li>
            <li role="menuitem">
              <div class="notif-item">
                <i class="notif-icon fas fa-exclamation-triangle"></i>
                <div>2 sản phẩm sắp hết HSD</div>
                <span class="notif-time">1 giờ trước</span>
              </div>
            </li>
            <li role="menuitem">
              <div class="notif-item">
                <i class="notif-icon fas fa-undo"></i>
                <div>1 yêu cầu hoàn tiền cần xử lý</div>
                <span class="notif-time">Hôm nay</span>
              </div>
            </li>
          </ul>
          <a href="#" class="notif-viewall" role="menuitem">Xem tất cả thông báo</a>
        </div>
      </div>
      
      <div class="admin-user">
        <img src="../assets/images/avatar_15657781.png" alt="Ảnh đại diện Admin" class="admin-avatar" loading="lazy">
        <div class="admin-user-info">
          <span class="admin-name" aria-label="Admin"> Admin </span>
          <span class="admin-role">Quản trị viên</span>
        </div>
        <button class="logout-btn" aria-label="Đăng xuất" title="Đăng xuất">
          <i class="fas fa-sign-out-alt"></i>
        </button>
      </div>
    </div>
  </header>
  <!-- MAIN LAYOUT -->
  <div class="admin-layout">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar" aria-label="Menu điều hướng chính" role="navigation">
      <h3>Danh mục quản trị</h3>
      <nav>
        <a href="admin_homepage.html" class="sidebar-link" data-label="Dashboard" data-page="dashboard">
          <img src="../assets/images/dashboard.png" alt="" class="menu-icon" loading="lazy">
          <span class="menu-text">Dashboard</span>
          <i class="menu-indicator"></i>
        </a>
        <a href="admin_ordmanagement.html" class="sidebar-link" data-label="Order Management" data-page="orders">
          <img src="../assets/images/order1.png" alt="" class="menu-icon" loading="lazy">
          <span class="menu-text">Quản lý đơn hàng</span>
          <i class="menu-indicator"></i>
        </a>
        <a href="admin_promanagement.html" class="sidebar-link" data-label="Product Management" data-page="products">
          <img src="../assets/images/drug.png" alt="" class="menu-icon" loading="lazy">
          <span class="menu-text">Quản lý sản phẩm</span>
          <i class="menu-indicator"></i>
        </a>
        <a href="admin_cusmanagement.html" class="sidebar-link active" data-label="Customer Management" data-page="customers">
          <img src="../assets/images/customer.png" alt="" class="menu-icon" loading="lazy">
          <span class="menu-text">Quản lý khách hàng</span>
          <i class="menu-indicator"></i>
        </a>
        <a href="admin_blogmanagement.html" class="sidebar-link" data-label="Marketing Management" data-page="marketing">
          <img src="../assets/images/marketing.png" alt="" class="menu-icon" loading="lazy">
          <span class="menu-text">Quản lý Blogs</span>
          <i class="menu-indicator"></i>
        </a>
        <a href="admin_faqmanagement.html" class="sidebar-link" data-label="Consultation & Support" data-page="support">
          <img src="../assets/images/consultation.png" alt="" class="menu-icon" loading="lazy">
          <span class="menu-text">Tư vấn & Hỗ trợ</span>
          <i class="menu-indicator"></i>
        </a>
      </nav>
    </aside>
    <!-- Main Content -->
    <main class="dashboard-content" id="main-content" tabindex="-1">
      <header class="page-header">
        <h2>Quản lý khách hàng</h2>
        <p>Theo dõi và quản lý thông tin khách hàng, lịch sử mua hàng.</p>
        <div class="page-actions">
          <button class="btn-refresh" id="refreshBtn"><i class="fas fa-sync-alt"></i> Làm mới</button>
          <button class="btn-export" id="exportBtn"><i class="fas fa-download"></i> Xuất báo cáo</button>
          <button class="btn-create" id="createCustomerBtn">
            <i class="fas fa-plus-circle"></i> Tạo khách hàng mới
          </button>
        </div>
      </header>
      <!-- FILTER BAR -->
      <section class="filter-bar">
        <div class="filter-group">
          <label for="nameFilter">Tên khách hàng</label>
          <input type="text" id="nameFilter" class="filter-input" placeholder="Tìm tên...">
        </div>
        <div class="filter-group">
          <label for="phoneFilter">Số điện thoại</label>
          <input type="text" id="phoneFilter" class="filter-input" placeholder="Tìm số...">
        </div>
        <div class="filter-group">
          <label for="dateFrom">Từ ngày</label>
          <input type="date" id="dateFrom" class="filter-input">
        </div>
        <div class="filter-group">
          <label for="dateTo">Đến ngày</label>
          <input type="date" id="dateTo" class="filter-input">
        </div>
        <button class="btn-apply" id="applyFilter">Áp dụng</button>
      </section>
      <!-- TABLE -->
      <div class="order-table-container">
        <table class="order-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Tên khách hàng</th>
              <th>Số điện thoại</th>
              <th>Địa chỉ</th>
              <th>Tổng đơn hàng</th>
              <th>Tổng chi tiêu</th>
              <th>Đơn hàng cuối</th>
              <th>Hành động</th>
            </tr>
          </thead>
          <tbody id="customerTableBody"></tbody>
        </table>
      </div>
      <!-- PAGINATION -->
      <div class="pagination" id="pagination"></div>
    </main>
  </div>
  <!-- CUSTOMER DETAIL MODAL -->
  <div class="modal" id="customerModal" role="dialog" aria-modal="true">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title"><i class="fas fa-user-edit"></i> Chi tiết khách hàng</h2>
        <button class="modal-close" id="closeModal"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="info-grid">
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">ID</span>
              <span class="info-value" id="cusId"></span>
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">Tên</span>
              <input type="text" id="cusName" class="info-value editable">
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">Số điện thoại</span>
              <input type="text" id="cusPhone" class="info-value editable">
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">Địa chỉ</span>
              <input type="text" id="cusAddress" class="info-value editable">
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">Tổng đơn hàng</span>
              <span class="info-value" id="cusOrders"></span>
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">Tổng chi tiêu</span>
              <span class="info-value" id="cusSpent"></span>
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <span class="info-label">Đơn hàng cuối</span>
              <span class="info-value" id="cusLastOrder"></span>
            </div>
          </div>
        </div>
        <!-- ORDER HISTORY -->
        <div class="order-history">
          <h4>Lịch sử đơn hàng</h4>
          <table class="history-table">
            <thead>
              <tr>
                <th>ID Đơn</th>
                <th>Ngày</th>
                <th>Tổng tiền</th>
                <th> Trạng thái đơn hàng</th>
              </tr>
            </thead>
            <tbody id="orderHistoryBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-- CREATE CUSTOMER MODAL -->
  <div class="modal" id="createCustomerModal" role="dialog" aria-modal="true">
    <div class="modal-content">
      <button class="modal-close" id="createCustomerClose">
        <i class="fas fa-times"></i>
      </button>
      <h3 class="modal-title">
        <i class="fas fa-user-plus"></i> Tạo khách hàng mới
      </h3>
      <div class="modal-body">
        <div class="info-grid">
          <div class="info-card">
            <div class="info-item">
              <label class="info-label" for="newCusName">Tên khách hàng</label>
              <input type="text" id="newCusName" class="filter-input" placeholder="VD: Nguyễn Văn A" required>
            </div>
          </div>
          <div class="info-card">
            <div class="info-item">
              <label class="info-label" for="newCusPhone">Số điện thoại</label>
              <input type="text" id="newCusPhone" class="filter-input" placeholder="VD: 0912345678" required>
            </div>
          </div>
          <div class="info-card" style="grid-column: 1 / -1;">
            <div class="info-item">
              <label class="info-label" for="newCusAddress">Địa chỉ</label>
              <input type="text" id="newCusAddress" class="filter-input" placeholder="VD: 123 Đường ABC, Quận 1, TP.HCM" required>
            </div>
          </div>
        </div>
      </div>
      <!-- ACTION BUTTONS -->
      <div class="modal-actions">
        <button class="btn-save" id="saveNewCustomer">
          <i class="fas fa-save"></i> Lưu khách hàng
        </button>
        <button class="btn-cancel-order" id="cancelNewCustomer">
          <i class="fas fa-times"></i> Hủy
        </button>
      </div>
    </div>
  </div>
  <!-- DELETE CONFIRM MODAL -->
  <div class="modal" id="deleteConfirmModal" role="dialog" aria-modal="true">
    <div class="modal-content delete-modal">
      <div class="delete-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <h3 class="delete-title">Xác nhận xóa khách hàng</h3>
      <p class="delete-message">Bạn có chắc chắn muốn xóa khách hàng này không?</p>
      <div class="delete-actions">
        <button class="btn-cancel-order" id="cancelDelete"><i class="fas fa-times"></i> Hủy</button>
        <button class="btn-delete-confirm" id="confirmDelete"><i class="fas fa-trash-alt"></i> Xóa</button>
      </div>
    </div>
  </div>
  <!-- FOOTER -->
  <footer class="footer" role="contentinfo">
    <div class="footer-inner">
      <div class="footer-content">
        <div class="footer-section">
          <h3><i class="fas fa-info-circle"></i> VỀ MEDICARE</h3>
          <a href="#" aria-label="Giới thiệu MediCare">Giới thiệu</a>
          <a href="#" aria-label="Chính sách bảo mật">Chính sách bảo mật</a>
          <a href="#" aria-label="Hỗ trợ kỹ thuật">Hỗ trợ kỹ thuật</a>
        </div>
        
        <div class="footer-section">
          <h3><i class="fas fa-phone"></i> LIÊN HỆ</h3>
          <div><i class="fas fa-headset"></i> 1900 0908</div>
          <div><i class="fas fa-envelope"></i> <a href="mailto:support@medicare.vn">support@medicare.vn</a></div>
        </div>
        
        <div class="footer-section">
          <h3><i class="fas fa-cogs"></i> QUẢN TRỊ</h3>
          <a href="#" aria-label="Cài đặt tài khoản">Cài đặt tài khoản</a>
          <a href="#" aria-label="Quản lý người dùng">Quản lý người dùng</a>
          <a href="#" aria-label="Báo cáo hệ thống">Báo cáo hệ thống</a>
        </div>
        
        <div class="footer-section">
          <h3><i class="fas fa-question-circle"></i> TRỢ GIÚP</h3>
          <a href="#" aria-label="Hướng dẫn sử dụng">Hướng dẫn sử dụng</a>
          <a href="#" aria-label="Câu hỏi thường gặp">FAQs</a>
          <a href="#" aria-label="Liên hệ hỗ trợ">Liên hệ hỗ trợ</a>
        </div>
      </div>
      <div class="footer-bottom">
        <span>&copy; 2025 MediCare Admin Control Panel. All rights reserved.</span>
        <span class="footer-version">v1.1.0</span>
      </div>
    </div>
  </footer>
</body>
</html>